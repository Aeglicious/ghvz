
<dom-module id="ghvz-desktop-app">
  <script>
    // Not sure why this HTMLImports.whenReady is really needed.
    // Something about polymer initialization order.
    // I think we're not supposed to need this.
    HTMLImports.whenReady(() => {
      Polymer({
        is: 'ghvz-desktop-app',

        properties: {
          bridge: Object,
          database: Object,

          userId: {
            type: String,
          },

          gameId: {
            type: String,
            notify: true,
          },

          playerId: {
            type: String,
            notify: true,
          },

          page: {
            type: String,
            value: '',
          },
        },

        signOut_: function() {
          this.bridge.signOut();
        },

        computeShowMainPage_(page) { return page == ''; }
        computeShowStatsPage_(page) { return page == 'stats'; }
      });
    });
  </script>
  <template>
  	<style>
      :host {
        display: block;
        position: relative;
        background-color: #f4f4f4;
      }
      .content {
        display: block;
        margin: 16px;
      }
      #viewControls paper-checkbox {
        margin-left: 16px;
      }
      #topControls {
        display: flex;
        justify-content: space-between;
        padding: 0 16px;
        align-items: center;
      }
      #info {
        display: flex;
        justify-content: flex-end;
        padding: 0 16px;
        align-items: center;
      }
      .info {
        margin-left: 32px;
        text-align: center;
      }
  	</style>

    <div id="topControls">
      <ghvz-game-selector
          user-id="[[userId]]"
          user="[[database.user]]"
          games="[[database.games]]"
          game-id="{{gameId}}"
          player-id="{{playerId}}">
      </ghvz-game-selector>

      <div id="confidential">
        DONT POST CONFIDENTIAL INFO, COBFLABBIT!
      </div>

      <div id="viewControls">
        <paper-checkbox checked="{{isAdmin}}">Is Admin</paper-checkbox>
        <paper-checkbox checked="{{isZombie}}">Is Zombie</paper-checkbox>
      </div>

      <paper-button on-tap="signOut_">Sign Out</paper-button>
    </div>

    <div id="info">
      <div class="info">
        userId [[userId]]
      </div>

      <div class="info">
        gameId [[gameId]]
      </div>

      <div class="info">
        playerId [[playerId]]
      </div>
    </div>

    <template is="dom-if" if="[[computeShowMainPage_(page)]]">
      <ghvz-desktop-main-page
          bridge="[[bridge]]"
          database="[[database]]"
          game-id="[[gameId]]"
          user-id="[[userId]]"
          player-id="[[playerId]]">
      </ghvz-desktop-main-page>
    </template>

    <template is="dom-if" if="[[computeShowStatsPage_(page)]]">
      <ghvz-stats-page
          bridge="[[bridge]]"
          database="[[database]]"
          game-id="[[gameId]]"
          user-id="[[userId]]"
          player-id="[[playerId]]">
      </ghvz-stats-page>
    </template>
  </template>
</dom-module>
