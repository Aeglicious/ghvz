
<dom-module id="ghvz-desktop-app">
  <script>
    // Not sure why this HTMLImports.whenReady is really needed.
    // Something about polymer initialization order.
    // I think we're not supposed to need this.
    HTMLImports.whenReady(() => {
      Polymer({
        is: 'ghvz-desktop-app',

        properties: {
          bridge: Object,
          database: Object,
          user: Object,
          game: Object,
          player: Object,
          page: String,

          showPage: {
            type: Object,
            value: {
              'main': 'main',
              'chat': 'chat',
              'joinGame': 'joinGame',
              'notifications': 'notifications',
              'profile': 'profile',
              'stats': 'stats',
            },
          },
        },

        computeShowPage_(desiredPage, page) {
          if (this.page && this.page.startsWith(desiredPage)) {
            return true;
          }
          return false;
        },
      });
    });
  </script>
  <style>
    :host {
      display: block;
      position: relative;
      background-color: #f4f4f4;
      padding: 8px;
      height: 100%;
      width: 100%;
      box-sizing: border-box;
    }
  </style>
  <template>
    <template is="dom-if" if="[[computeShowPage_(showPage.main, page)]]">
      <ghvz-desktop-main-page
          bridge="[[bridge]]"
          database="[[database]]"
          game="[[game]]"
          user="[[user]]"
          player="[[player]]">
      </ghvz-desktop-main-page>
    </template>

    <template is="dom-if" if="[[computeShowPage_(showPage.joinGame, page)]]">
      <ghvz-card spaced expand>
        <div class="header">Join Game</div>
        <ghvz-game-registration
              class="content"
              bridge="[[bridge]]"
              game="[[game]]"
              user-id="[[user.id]]">
        </ghvz-game-registration>
      </ghvz-card>
    </template>

    <template is="dom-if" if="[[computeShowPage_(showPage.stats, page)]]">
      <ghvz-card full spaced>
        <div class="header">Game Stats</div>
        <ghvz-stats-page
            bridge="[[bridge]]"
            database="[[database]]"
            game="[[game]]"
            user="[[user]]"
            player="[[player]]">
        </ghvz-stats-page>
      </ghvz-card>
    </template>

    <template is="dom-if" if="[[computeShowPage_(showPage.chat, page)]]">
      <ghvz-card full spaced>
        <ghvz-chat-page
            bridge="[[bridge]]"
            database="[[database]]"
            game="[[game]]"
            user="[[user]]"
            player="[[player]]"
            page="[[page]]">
        </ghvz-chat-page>
      </ghvz-card>
    </template>

    <template is="dom-if" if="[[computeShowPage_(showPage.notifications, page)]]">
      <ghvz-card full spaced>
        <div class="header">Notifications</div>
        <ghvz-notifications-page
            bridge="[[bridge]]"
            categories-by-id="[[game.notificationCategoriesById]]"
            categories="[[game.notificationCategories]]"
            player="[[player]]"
            page="[[page]]">
        </ghvz-notifications-page>
      </ghvz-card>
    </template>
  </template>
</dom-module>
