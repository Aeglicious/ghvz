<dom-module id="ghvz-chat-room-list">
  <script>
    // Not sure why this HTMLImports.whenReady is really needed.
    // Something about polymer initialization order.
    // I think we're not supposed to need this.
    HTMLImports.whenReady(() => {
      Polymer({
        is: 'ghvz-chat-room-list',

        properties: {
          game: String,
        },

        listeners: {
          'tap': 'captureTap_',
        },

        captureTap_(e) {
          console.log(e.target);
          console.log(e.target.dataset);
          let page = e.target.dataset.page;
          this.fire('ghvz-open-page', {
            page: page,
          });
          e.preventDefault();
          e.stopPropagation();
        },

        computeChatPage_(chatRoomId) {
          console.log("chatroomid: ", chatRoomId);
          return "blah";
          //return "chat/" + chatRoomId;
        },
      });
    });
  </script>
  <style include="iron-flex iron-flex-alignment">
    :host {
      display: block;
    }
    .frame {
      padding-left: 8px;
      padding-right: 8px;
      padding-top: 4px;
      padding-bottom: 4px;
    }
    .listing {
      padding-top: 4px;
      padding-bottom: 4px;
    }
  </style>
  <template>
    <div class="frame" on-tap="captureTap_">
      <template is="dom-repeat" items="[[game.chatRooms]]" as="chatRoom">
        <div class="layout horizontal listing">
          <a href="javascript:void(0)" data-page$="computeChatPage_(chatRoom.id)]]">
            <iron-icon icon="communication:chat"></iron-icon>
            [[chatRoom.name]]
          </a>
        </div>
      </template>
    </div>
  </template>
</dom-module>