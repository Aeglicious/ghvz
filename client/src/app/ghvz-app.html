<style>
  body {
    font-family: 'Roboto', 'Noto', sans-serif;
    -webkit-font-smoothing: antialiased;
    padding: 0 !important;
    margin: 0 !important;
  }

  /* whoever designed the default paper-menu needs to be shot */
  paper-menu,
  paper-listbox {
    padding: 0 !important;
  }
  paper-menu .iron-selected,
  paper-listbox .iron-selected {
    font-weight: inherit !important;
  }
  paper-menu paper-item,
  paper-listbox paper-item {
    min-height: 36px !important;
    white-space: nowrap;
  }
  paper-listbox paper-item::before,
  paper-listbox paper-item::after,
  paper-menu paper-item::before,
  paper-menu paper-item::after {
    display: none;
  }
  paper-listbox paper-item:hover,
  paper-menu paper-item:hover {
    background-color: #F0F0F0 !important;
    cursor: pointer;
  }

  paper-input-container {
    padding: 0 !important;
  }
</style>

<dom-module id="ghvz-app">
  <script>
    // Not sure why this HTMLImports.whenReady is really needed.
    // Something about polymer initialization order.
    // I think we're not supposed to need this.
    HTMLImports.whenReady(() => {
      Polymer({
        is: 'ghvz-app',

        properties: {
          derp: {
            type: Number,
            value: 3,
          },

          self: {
            type: Object,
            computed: 'computeThis_(derp)',
          },

          isDesktop: {
            type: Boolean,
            value: () => !window.matchMedia("only screen and (max-width: 760px)").matches,
          },

          userId: {
            type: String,
          },

          games: {
            type: Array,
            value: () => ([]),
          },

          gamesById: {
            value: Object,
            value: () => ({}),
          },

          gameId: {
            type: String,
            value: null,
          },

          game: {
            type: Object,
            value: null,
          },

          playerId: {
            type: String,
            value: null,
          },

          guns: {
            type: Array,
            value: () => ([]),
          },

          gunsById: {
            type: Object,
            value: () => ({}),
          },
        },

        computeThis_: function() {
          return this;
        },

        firebaseSignIn_: function() {
          this.$.firebase.signIn();
        },
      });
    });
  </script>
  <template>
    <ghvz-firebase
        id="firebase"
        user-id="{{userId}}"
        game-id="{{gameId}}"
        player-id="{{playerId}}"
        target="[[self]]">
    </ghvz-firebase>
    <template is="dom-if" if="[[!userId]]">
      <paper-button on-tap="firebaseSignIn_">Sign In</paper-button>
    </template>
    <template is="dom-if" if="[[userId]]">
      <template is="dom-if" if="[[isDesktop]]">
        <ghvz-desktop-app
            server-bridge="[[serverBridge]]"
            user-id="[[userId]]"
            games="[[games]]"
            game-id="{{gameId}}"
            player-id="{{playerId}}"
            game="[[game]]"
            guns="[[guns]]">
        </ghvz-desktop-app>
      </template>
      <template is="dom-if" if="[[!isDesktop]]">
        <ghvz-mobile-app
            server-bridge="[[serverBridge]]"
            user-id="[[userId]]"
            games="[[games]]"
            game-id="{{gameId}}"
            player-id="{{playerId}}"
            game="[[game]]"
            guns="[[guns]]">
        </ghvz-mobile-app>
      </template>
    </template>
  </template>
</dom-module>
